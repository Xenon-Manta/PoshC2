

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>First Time Use &mdash; PoshC2 Framework  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PoshC2 Framework  documentation" href="../index.html"/>
        <link rel="up" title="Installation &amp; Setup" href="index.html"/>
        <link rel="next" title="Updating PoshC2" href="updating.html"/>
        <link rel="prev" title="Getting Started" href="getting_started.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PoshC2 Framework
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Installation &amp; Setup</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">First Time Use</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-folder">Installation Folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#c2-server">C2 Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implant-handler">Implant Handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#team-viewer">Team Viewer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#project-folder">Project Folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quickedit-mode">QuickEdit Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clockwork-sms">Clockwork SMS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="updating.html">Updating PoshC2</a></li>
<li class="toctree-l2"><a class="reference internal" href="help.html">Pre-Implant Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="help2.html">Post-Implant Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="domfronting.html">Domain Fronting</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache.html">Apache Rewrite Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="whitelist.html">Apache Whitelist</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html">Contribute</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../execution/index.html">Execution / Payloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/index.html">Core Implant / Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../persistence/index.html">Persistence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lateral_movement/index.html">Lateral Movement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporting/index.html">Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license/index.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PoshC2 Framework</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Installation &amp; Setup</a> &raquo;</li>
        
      <li>First Time Use</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/install_and_setup/firsttime.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="first-time-use">
<h1>First Time Use<a class="headerlink" href="#first-time-use" title="Permalink to this headline">¶</a></h1>
<p>PoshC2 ships as a self-contained folder with the relevant components and subsequent shortcuts to start the server and implant-handler. The C2 server is the Powershell web server component, whereas the implant-handler is where you can interact with your implants.</p>
<p>Ensure you have all the relevant components and make sure Anti-Virus hasn’t quarantined any files before starting the server.</p>
<div class="section" id="installation-folder">
<h2>Installation Folder<a class="headerlink" href="#installation-folder" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="../_images/folder.png"><img alt="../_images/folder.png" src="../_images/folder.png" style="width: 600pt;" /></a>
</div>
<div class="section" id="c2-server">
<h2>C2 Server<a class="headerlink" href="#c2-server" title="Permalink to this headline">¶</a></h2>
<p>To start the C2 Server run the link below, this will ask for elevation as it opens an HTTP or HTTPS port when the server starts.</p>
<div class="highlight-powershell"><div class="highlight"><pre><span></span><span class="nb">Start-C2</span><span class="n">-Server</span><span class="p">.</span><span class="n">lnk</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/server.png"><img alt="../_images/server.png" src="../_images/server.png" style="width: 600pt;" /></a>
<p>Once the server opens, it will ask a series of questions that can either be left as default of changed depending on your risk appetite and your C2 setup.</p>
<p><strong>[1] Enter the IP address or Hostname of the Posh C2 server (External address if using NAT) [IP]:</strong></p>
<p>This input is the hostname or IP address that will be configured for the dropper, therefore you behind a firewall the default IP address that is prompted is probably incorrect. Ensure this is the internet facing hostname or IP that will be used for comms.</p>
<p><strong>[2] Do you want to use HTTPS for implant comms? [Yes]:</strong></p>
<p>By default, PoshC2 will configure the implant to use HTTPS but it can be used over plain text HTTP if required. All communications are encrypted within the HTTP content therefore comms are still secure even over HTTP. There is an added benefit to HTTPS, because unless the organisation is perform SSL inspection the communications cannot be checked.</p>
<p><strong>[2a] Do you want PoshC2 to use default and permit self-signed SSL certificates [Yes]:</strong></p>
<p>This option either allows self-signed certificates to be used or not. If this is configured, the implant will set this option before execution: <code class="docutils literal"><span class="pre">[System.Net.ServicePointManager]::ServerCertificateValidationCallback</span> <span class="pre">=</span> <span class="pre">{$true}</span></code>.</p>
<p>This also installs a default SSL certificate that ships with PoshC2 by using “Netsh.exe”. If you want to use your own certificate PoshC2 will provide the commands to install this manually.</p>
<p><strong>[2b] Do you want to use domain fronting? [No]:</strong></p>
<p>PoshC2 can now use domain fronting for comms. There is a caveat to this; the host must have .NET v4.0.30319 installed and usable to the PowerShell instance. However, if the host does not have this version of the CLR installed it will default back to the underlying CDN hostname, for example cloudfront.net or azureedge.net. The way we perform domain fronting in PoshC2 is by adding the Host header to the web requests.</p>
<p>This is a much stealthier option for comms as you can utilise hostnames with better reputation without needing to buy new domains and obtain reputation yourself. If you want to use domain fronting, then select Yes here and the next question appears.</p>
<p><strong>[2c] Please specify the host header for domain fronting?</strong></p>
<p>Enter the domain fronting header you want to use in PoshC2, e.g. flsiesfds.cloudfront.net</p>
<p><strong>[3a] Do you want to customize the beacon URLs from the default? [No]:</strong></p>
<p>If you want to customize the beacon URLs in PoshC2 you can do so here, this will auto generate your Apache Rewrite configuration as well. To do this type “Yes” and enter the URLs. These can be pasted in too, to finish the URL entry just enter a blank line and this will tell PoshC2 you have finished entering URLs. An example of URLs can be shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">v1</span><span class="o">/</span><span class="n">site</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">images</span><span class="o">.</span><span class="n">html</span>
<span class="n">printer</span><span class="o">/</span><span class="n">navigate</span><span class="o">/</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">2018</span><span class="o">/</span><span class="mi">8</span><span class="o">/</span>
<span class="n">cgi</span><span class="o">-</span><span class="nb">bin</span><span class="o">/</span><span class="n">conf</span><span class="o">.</span><span class="n">pl</span>
</pre></div>
</div>
<p><strong>[3b] Do you want to customize the beacon URLs from the Socks Proxy (SharpSocks)? [No]:</strong></p>
<p>If you want to customize the SharpSocks URLs in PoshC2 you can do so here, this will auto generate your Apache Rewrite configuration as well. To do this type “Yes” and enter the URLs. These can be pasted in too, to finish the URL entry just enter a blank line and this will tell PoshC2 you have finished entering URLs. An example of URLs can be shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">v2</span><span class="o">/</span><span class="n">site</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">images</span><span class="o">.</span><span class="n">html</span>
<span class="n">sharp</span><span class="o">/</span><span class="n">navigate</span><span class="o">/</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">2018</span><span class="o">/</span><span class="mi">8</span><span class="o">/</span>
<span class="n">p1</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="nb">bin</span><span class="o">/</span><span class="n">conf</span><span class="o">.</span><span class="n">pl</span>
</pre></div>
</div>
<p><strong>[4a] Do you want to customize the default UserAgent? [No]:</strong></p>
<p>PoshC2 will use the following UserAgent: <code class="docutils literal"><span class="pre">Mozilla/5.0</span> <span class="pre">(Windows</span> <span class="pre">NT</span> <span class="pre">6.3;</span> <span class="pre">WOW64;</span> <span class="pre">Trident/7.0;</span> <span class="pre">Touch;</span> <span class="pre">rv:11.0)</span> <span class="pre">like</span> <span class="pre">Gecko</span></code></p>
<p>If you want to customize this option, type “Yes” and enter the UserAgent here:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Mozilla</span><span class="o">/</span><span class="mf">6.0</span> <span class="p">(</span><span class="n">Windows</span> <span class="n">NT</span> <span class="mf">6.3</span><span class="p">;</span> <span class="n">Trident</span><span class="o">/</span><span class="mf">7.0</span><span class="p">;</span> <span class="n">Touch</span><span class="p">;</span> <span class="n">rv</span><span class="p">:</span><span class="mf">11.0</span><span class="p">)</span> <span class="n">like</span> <span class="n">Gecko</span>
</pre></div>
</div>
<p><strong>[4b] Do you want to a referer header? [No]:</strong></p>
<p>By default the referrer header is blank, however, if you prefer to have a referrer header in the comms type “Yes” and enter the referrer here:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>https://www.google.co.uk?site=us
</pre></div>
</div>
<p><strong>[5] Enter a new folder name for this project [PoshC2-2018-14-02-1456]:</strong></p>
<p>This is the name of the folder that stores all information and payloads for the current project and database. This will default to a random time/date unless stated.</p>
<p><strong>[6] Enter the default beacon time of the Posh C2 Server - 30s, 5m, 1h (10% jitter is always applied) [5s]:</strong></p>
<p>Enter the default beacon time, this can be changed later by using the Implant-Handler. If you wish to change this you can enter a time in seconds (<code class="docutils literal"><span class="pre">s</span></code>), minutes (<code class="docutils literal"><span class="pre">m</span></code>), or hours (<code class="docutils literal"><span class="pre">h</span></code>).</p>
<p><strong>[7] Enter the auto Kill Date of the implants in this format dd/MM/yyyy [28/02/2018]:</strong></p>
<p>The <code class="docutils literal"><span class="pre">Kill</span> <span class="pre">Date</span></code> option is a safety net for both consultants performing Red Teaming and organisations being targeted. If persistence cannot be removed or the payloads are still active in emails or documents, the payload/dropper will not execute if the time has elapsed. The default is two weeks passed the start date but can be changed as long as the format is correct.</p>
<p><strong>[8] Enter the HTTP port you want to use, 80/443 is highly preferable for proxying [443]:</strong></p>
<p>Highly recommended that this option is left default, however, if you want to run the server on a separate port this is the place to do it. This will configure all payloads to that port.</p>
<p><strong>[9] Do you want to enable sound? [Yes]:</strong></p>
<p>This option will enable sound, when a new implant arrives it will tell you.</p>
<p><strong>[10] Do you want to use Clockwork SMS for new payloads? [No]:</strong></p>
<p><a class="reference external" href="https://www.clockworksms.com">ClockworkSMS</a> is a SMS service provider that can be used for sending texts. PoshC2 integrates this service to send a text message when a new implant arrives. This is an optional configuration, however, if you want to integrate this, then all you need to do is sign up and add an <code class="docutils literal"><span class="pre">API</span> <span class="pre">key</span></code> and <code class="docutils literal"><span class="pre">Phone</span> <span class="pre">number</span></code> to the initial setup.</p>
<p>This will then send you a text message when an implant arrives.</p>
<p><strong>[11] Do you want all payloads or select limited payloads that shouldn’t be caught by AV? [Yes]:</strong></p>
<p>If you are running PoshC2 on the inside or on a machine where Anti-Virus may be resident, you can cut down on the payloads generated by saying “No” to this option. This will generate the core payloads only, e.g. standalone executable, service executable and batch files.</p>
<p>Once this has been entered PoshC2 should start running and generating all payloads. Once this has done you’re all setup and ready to go.</p>
</div>
<div class="section" id="implant-handler">
<h2>Implant Handler<a class="headerlink" href="#implant-handler" title="Permalink to this headline">¶</a></h2>
<p>The implant-handler auto-starts when running the C2 server, however, in the new project folder there will be a shortcut..</p>
<a class="reference internal image-reference" href="../_images/ih.png"><img alt="../_images/ih.png" src="../_images/ih.png" style="width: 600pt;" /></a>
</div>
<div class="section" id="team-viewer">
<h2>Team Viewer<a class="headerlink" href="#team-viewer" title="Permalink to this headline">¶</a></h2>
<p>The Team Viewer window is for when you are using a central server to host the C2 Server and would like more than one user to connect to the database and interact with clients. Usually the best way to achieve this is to map the project folder to a share and then pass this to the Team Viewer window when first opened.</p>
</div>
<div class="section" id="project-folder">
<h2>Project Folder<a class="headerlink" href="#project-folder" title="Permalink to this headline">¶</a></h2>
<p>Each project creates a unique folder to store all data and downloads specific to that engagement, including unique encryption keys. This means if you have shellcode pre-configured for one project, this will not connect to another project as the encryption keys will not match, so something to be aware of. This is an in-built safety measure to ensure someone else cannot just accept your connections from any PoshC2 dropper if they were able to replicate the backend for any reason.</p>
<a class="reference internal image-reference" href="../_images/folder.png"><img alt="../_images/folder.png" src="../_images/folder.png" style="width: 600pt;" /></a>
</div>
<div class="section" id="quickedit-mode">
<h2>QuickEdit Mode<a class="headerlink" href="#quickedit-mode" title="Permalink to this headline">¶</a></h2>
<p>In Powershell the option “QuickEdit” is on by default, however this comes with advantages and disadvantages to the end user. For example, if a user highlights the C2 Server window to copy and paste output it will automatically stop execution by default. This will in turn stop all hosts beaconing and therefore to defer a user from accidentally highlighting the server window untick the following setting on your Powershell default properties bar or run a simple registry change to disable this feature by default. It is worth noting you can still copy and paste the output by right-click and select “mark” similarly to how you would on a command prompt window:</p>
<div class="highlight-powershell"><div class="highlight"><pre><span></span><span class="nb">Set-ItemProperty</span> <span class="s2">&quot;HKCU:Console&quot;</span> <span class="n">QuickEdit</span> <span class="n">0</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/editmode.png"><img alt="../_images/editmode.png" src="../_images/editmode.png" style="width: 300pt;" /></a>
</div>
<div class="section" id="clockwork-sms">
<h2>Clockwork SMS<a class="headerlink" href="#clockwork-sms" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.clockworksms.com">ClockworkSMS</a> is a SMS service provider that can be used for sending texts. PoshC2 integrates this service to send a text message when a new implant arrives. This is an optional configuration, however, if you want to integrate this then all you need to do is sign up and add an <code class="docutils literal"><span class="pre">API</span> <span class="pre">key</span></code> and <code class="docutils literal"><span class="pre">Phone</span> <span class="pre">number</span></code> to the initial setup.</p>
<p>This will then send you a text message when an implant arrives.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">From</span><span class="p">:</span> <span class="n">PoshC2</span>
<span class="n">Message</span><span class="p">:</span> <span class="n">NewImplant</span><span class="p">:</span> <span class="n">Domain</span> \ <span class="n">Username</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="updating.html" class="btn btn-neutral float-right" title="Updating PoshC2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_started.html" class="btn btn-neutral" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Nettitude.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>